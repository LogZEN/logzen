{% extends "base.html" %}

{% block title %}Overview{% endblock %}

{% block content %}

<div class="left_graphs">
	<div class="left">
		<h2>Events by Host</h2>
		<div id="events_by_host" style="height: 200px; width: 100%;"></div>
	</div>
	<div class="right">
		<h2>TOP 5 Host</h2>
		<div id="top_hosts" style="height: 200px; width: 100%;"></div>
	</div>
</div>


<script>
var piecolors = ['#a40000','#204a87', '#4e9a06', '#ce5c00']

$.plot($('#events_by_host'),
		[
			{% for c in events_by_host %}
				{label: "{{c.host}}", data: {{c.count}}, color: piecolors[{{loop.index}}]}{% if loop.last != true %},{% endif %}
			{% endfor %}
		], {
	series: {
	    pie: {
	        show: true,
            radius: 1,
            combine: {
                color: '#2e3436',
                threshold: 0.1
            },
            stroke: {
            	color: '#ccc'
            },
			label: {
			    show: true,
			    radius: 3/4,
			    formatter: function(label, series) {
                    return '<div style="font-size:8pt;text-align:center;padding:2px;color:white;">'+label+'<br/>'+Math.round(series.percent)+'%</div>'
			    },
			    background: { opacity: 0.6 }
			}
	    }
	},
    legend: {
        show: false
    },
    grid: {
        hoverable: true
    }
});
$.plot($('#top_hosts'),
		[[
			{% for c in top_hosts %}
				[{{loop.index}}, {{c.count}}]{% if loop.last != true %},{% endif %}
			{% endfor %}
		]], {
	xaxis: {
		ticks: [
				{% for c in top_hosts %}
					[{{loop.index}}, "{{c.host}}"]{% if loop.last != true %},{% endif %}
				{% endfor %}
				],
	},
	bars: {
	      show: true,
	      lineWidth: 1,
          align: "center",
          barWidth: 0.6,
	      fill: true,
	      fillColor: { colors: ["#729fcf", "#3465af"] }
	},
    legend: {
        show: false
    },
	grid: { 
		hoverable: true, 
		autoHighlight: true 
	},
	tooltip: true,
	tooltipOpts: {
		content: "%y",
		defaultTheme:  false
	},
	colors: ["#204a87"],
});
</script>

{% endblock %}