// Generated by CoffeeScript 1.6.3
/*
Copyright 2013 Sven Reissmann <sven@0x80.io>

This file is part of LogZen. It is licensed under the terms of the
GNU General Public License version 3. See <http://www.gnu.org/licenses/>.
*/


(function() {
  define(['jquery', 'knockout', 'ko_mapping', 'pager', 'vars', 'bootstrap'], function($, ko, mapping, pager, vars) {
    var DashboardModel,
      _this = this;
    ko.bindingHandlers.widget = {
      init: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var childBindingContext, value;
        value = ko.utils.unwrapObservable(valueAccessor());
        ko.utils.setHtml(element, value.html);
        childBindingContext = bindingContext.createChildContext(value.vm);
        console.log(childBindingContext);
        ko.applyBindingsToDescendants(childBindingContext, element);
        return {
          controlsDescendantBindings: true
        };
      }
    };
    DashboardModel = (function() {
      function DashboardModel() {
        var _this = this;
        this.widgetModels = ko.observableArray([]);
        this.layout = mapping.fromJS([]);
        $.ajax({
          url: '/_config/dashboard/layout',
          dataType: 'json',
          success: function(result) {
            console.log(result);
            return mapping.fromJS(result, _this.layout);
          }
        });
      }

      return DashboardModel;

    })();
    return DashboardModel;
  });

}).call(this);
