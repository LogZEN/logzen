<div class="eventlist">

  <div id="loading" data-bind="visible: loading"></div>

  <!-- error handling -->
  <!--  ko if: error -->
  <div class="row">
    <div class="col-md-12">
      <div class="alert alert-block alert-danger">
        <strong>Error:</strong>
        <span data-bind="text: error"></span>
      </div>
    </div>
  </div>
  <!-- /ko -->
  

  <!-- eventlist navigation -->
  <div class="row">
    <div class="evlist_nav col-md-12">
      <span class="eventcount">
        Showing events <span data-bind="text: hits() > 0 ? (page() * 50 + 1) : 0"></span> - <span data-bind="text: (hits() > page() * 50 + 50) ? (page() * 50 + 50) : hits()"></span>
      </span>
      <span class="btn-group">
        <a class="btn btn-default btn-small left q_tip" title="Newest events" href="javascript:void(0);" data-bind="click: firstPage">First</a>
        <a class="btn btn-default btn-small q_tip" title="Newer events" href="javascript:void(0);" data-bind="click: prevPage">Prev</a>
        <a class="btn btn-default btn-small q_tip" title="Older events" href="javascript:void(0);" data-bind="click: nextPage">Next</a>
        <a class="btn btn-default btn-small right q_tip" title="Oldest events" href="javascript:void(0);" data-bind="click: lastPage">Last</a>
      </span>
      <span class="btn-group">
        <a class="btn btn-small q_tip active" title="Refresh" href="javascript:void(0);" data-toggle="button" data-bind="click: refreshPage, css: { 'btn-primary': refreshId() != -1, 'btn-default': refreshId() == -1 }">Refresh</a>
      </span>
    </div>
  </div>
  
  <!-- graph -->
  <!--
  <div class="row-fluid">
   	<div class="span12">
  	  <div id="timeSeries" style="width: 100%"><svg></svg></div>
   	</div>
  </div>
  -->

  <!-- freetext query -->
  <div class="modal" id="widgetNumberError" data-bind="visible: filterMode() == 'freetext'">
    <div class="modal-header">
      <button type="button" class="close" data-bind="click: function (data, event) { filterMode('fields'); }">&times;</button>
      <h3>Freetext query</h3>
    </div>
    <div class="modal-body">
      <pre contenteditable="true" id="filter_freetext" class="textarea prettyjson" data-bind="html: freetextValueFormatted"></pre>
    </div>
    <div class="modal-footer">
      <a href="#" class="btn btn-primary">Submit</a>
      <a href="#" class="btn" data-bind="click: function (data, event) { filterMode('fields'); }">Close</a>
    </div>
  </div>
  
      
  <!-- results and filters -->
  <div class="tab-pane active" id="tab1">  
    <div class="row">
      <div class="col-md-12">
        <form action="/_api/query" method="post" id="filterform" class="form-inline">
        <table class="events table-condensed">
          <thead>
            <tr>
              <th class="column_menu">&nbsp;</th>
              <th>Time</th>
              <th>Severity</th>
              <th>Facility</th>
              <th>Host</th>
              <th>Program</th>
              <th>Message</th>
            </tr>
            <tr>
              <th class="column_menu"><button type="button" class="close" data-bind="click: function (data, event) { filterMode('freetext'); }"><i class="fa fa-fw fa-edit"></i></button></th>

              <th class="input-col" id="column_time">
                <input type="text" name="timereported" id="filter_time" class="form-control input-sm" placeholder="" readonly="readonly" size="5" />
              </th>

              <th class="input-col" id="column_severity">
                <div class="input-group">
                  <input type="text" name="severity" id="filter_severity" class="form-control input-sm filter" placeholder="filter" size="5" data-bind="value: filters.severity, valueUpdate: 'afterkeydown'" data-provide="typeahead" data-items="4" data-source='["emerge","alert","critical","error","warning","notice","info","debug"]' />
                  <span class="input-group-addon"><i class="fa fa-fw fa-undo q_tip" id="severity" title="Clear this filter" data-bind="click: clearFilter('severity')"></i></span>
                </div>
              </th>

              <th class="input-col" id="column_facility">
                <div class="input-group">
                  <input type="text" name="facility" id="filter_facility" class="form-control input-sm filter" placeholder="filter" size="5" data-bind="value: filters.facility, valueUpdate: 'afterkeydown'" />
                  <span class="input-group-addon"><i class="fa fa-fw fa-undo q_tip" id="facility" title="Clear this filter" data-bind="click: clearFilter('facility')"></i></span>
                </div>
              </th>

              <th class="input-col" id="column_host">
                <div class="input-group">
                  <input type="text" name="fromhost" id="filter_fromhost" class="form-control input-sm filter" placeholder="filter" size="5" data-bind="value: filters.host, valueUpdate: 'afterkeydown'" />
                  <span class="input-group-addon"><i class="fa fa-fw fa-undo q_tip" id="host" title="Clear this filter" data-bind="click: clearFilter('host')"></i></span>
                </div>
              </th>

              <th class="input-col" id="column_program">
                <div class="input-group">
                  <input type="text" name="program" id="filter_program" class="form-control input-sm filter" placeholder="filter" size="5" data-bind="value: filters.program, valueUpdate: 'afterkeydown'" />
                  <span class="input-group-addon"><i class="fa fa-fw fa-undo q_tip" id="program" title="Clear this filter" data-bind="click: clearFilter('program')"></i></span>
                </div>
              </th>

              <th class="input-col" id="column_message">
                <div class="input-group">
                  <input type="text" name="message" id="filter_message" class="form-control input-sm filter" placeholder="filter" size="5" data-bind="value: filters.message, valueUpdate: 'afterkeydown'" />
                  <span class="input-group-addon"><i class="fa fa-fw fa-undo q_tip" id="message" title="Clear this filter" data-bind="click: clearFilter('message')"></i></span>
                </div>
              </th>
            </tr>
          </thead>

          <tbody>
          <!-- ko foreach: events -->
            <tr>
              <td class="column_menu">
                <ul class="nav hover-nav" style="display:inline-block">
                  <li class="dropdown">
                  <a class="dropdown-toggle plain" href="#"><i class="fa fa-fw fa-chevron-down"></i></a>
                    <ul class="dropdown-menu">
                      <li><a data-bind="attr: { href: detail_url}"><i class="fa fa-fw fa-info-circle"></i> Display details</a></li>
                      <li><a href="{{searchengine}}' + encodeURIComponent() + '"><i class="icon-globe"></i> Search with {{searchengine_name}}</a></li>
                    </ul>
                  </li>
                </ul>
                <i class="icon-eye-open event_tooltip" title="<%_id%>"></i>
              </td>

              <td data-bind="text: time"></td>
              <td><a data-bind="text: severity_text, click: $parent.setFilter('severity'), css: {
                color_emerge: severity == '0',
                color_alert: severity == '1',
                color_critical: severity == '2',
                color_error: severity == '3',
                color_warning: severity == '4',
                color_notice: severity == '5',
                color_info: severity == '6',
                color_debug: severity == '7'
              }" class="badge"></a></td>
              <td><a data-bind="text: facility_text,  click: $parent.setFilter('facility')"></a></td>
              <td><a data-bind="text: host,           click: $parent.setFilter('host')"></a></td>
              <td><a data-bind="text: program,        click: $parent.setFilter('program')"></a></td>
              <td><a data-bind="html: message_hl,     click: $parent.setFilter('message')"></a></td>
            </tr>
          <!-- /ko -->

          <!--  ko ifnot: events().length -->
            <tr><td colspan="13" class="noresults">No Events</td></tr>
          <!-- /ko -->
          </tbody>

        </table>
        </form>
      </div>
    </div>
  </div>

</div>
